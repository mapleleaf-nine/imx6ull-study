## gcc编译过程
- 一个C/C++文件要经过预处理(preprocessing)、编译(compilation)、汇编(assembly)和链接(linking)等4步才能变成可执行文件。
1. 编译过程命令介绍
    - 预处理 ：`.c`/`.cpp`文件   
    C/C++源文件中，以“#”开头的命令被称为预处理命令，如包含命令“#include”、宏定义命令“#define”、条件编译命令“#if”、“#ifdef”等。预处理就是将要包含(include)的文件插入原文件中、将宏定义展开、根据条件编译命令选择要使用的代码，最后将这些东西输出到一个“.i”文件中等待进一步处理。
    - 编译 ：`.i`文件 
    编译就是把C/C++代码(比如上述的“.i”文件)“翻译”成汇编代码，所用到的工具为ccl(它的名字就是cc1，x86有自己的cc1命令，ARM板也有自己的cc1命令)。
    - 汇编 ：`.s`文件 
    汇编就是将第二步输出的汇编代码翻译成符合一定格式的机器代码，在Linux系统上一般表现为ELF目标文件(OBJ文件)，用到的工具为as。x86有自己的as命令，ARM版也有自己的as命令，也可能是xxxx-as（比如arm-linux-as）。
    “反汇编”是指将机器代码转换为汇编代码，这在调试程序时常常用到。
    - 链接 : `.o`文件 
    链接就是将上步生成的OBJ文件和系统库的OBJ文件、库文件链接起来，最终生成了可以在特定平台运行的可执行文件，用到的工具为ld或collect2。
    - 完成前面四个步骤后形成可运行的app
2. 编译程序时加上"-v"选项 gcc -o hello hello.c -v
    - cpp -o hello.i hello.c
    - cc1 hello.i -o /tmp/cctETob7.s
    - as -o /tmp/ccvv2KbL.o /tmp/cctETob7.s
    - collect2 -o hello crt1.o crti.o crtbegin.o /tmp/ccvv2KbL.o crtend.o crtn.o
    - 可以看到gcc编译过程使用了那些工具
3. gcc命令选项
    - -c : 预处理、编译和汇编源文件，但是不作链接，编译器根据源文件生成OBJ文件。缺省情况下，GCC通过用`.o`替换源文件名的后缀`.c`，`.i`，`.s`等，产生OBJ文件名。可以使用-o选项选择其他名字。GCC忽略-c选项后面任何无法识别的输入文件。
    - -S :　编译后即停止，不进行汇编。对于每个输入的非汇编语言文件，输出结果是汇编语言文件。缺省情况下，GCC通过用`.s`替换源文件名后缀`.c`，`.i`等等，产生汇编文件名。可以使用-o选项选择其他名字。GCC忽略任何不需要汇编的输入文件。
    - -E : 预处理后即停止，不进行编译。预处理后的代码送往标准输出。
    - -o file : 指定输出文件为file。无论是预处理、编译、汇编还是链接，这个选项都可以使用。如果没有使用`-o`选项，默认的输出结果是：可执行文件为`a.out`；修改输入文件的名称是`source.suffix`，则它的OBJ文件是`source.o`，汇编文件是 `source.s`，而预处理后的C源代码送往标准输出。
    - -v : 显示制作GCC工具自身时的配置命令；同时显示编译器驱动程序、预处理器、编译器的版本号。
    - -Wall : 这个选项基本打开了所有需要注意的警告信息，比如没有指定类型的声明、在声明之前就使用的函数、局部变量除了声明就没再使用等。
4. 调试选项
    - -g ：以操作系统的本地格式(stabs，COFF，XCOFF，或DWARF)产生调试信息，GDB能够使用这些调试信息。在大多数使用stabs格式的系统上，`-g'选项加入只有GDB才使用的额外调试信息。
5. 优化选项
    - -O或-O1 : 优化：对于大函数，优化编译的过程将占用稍微多的时间和相当大的内存。不使用`-O'或`-O1'选项的目的是减少编译的开销，使编译结果能够调试、语句是独立的：如果在两条语句之间用断点中止程序，可以对任何变量重新赋值，或者在函数体内把程序计数器指到其他语句，以及从源程序中精确地获取你所期待的结果。
    不使用`-O`或`-O1`选项时，只有声明了register的变量才分配使用寄存器。
    使用了`-O`或`-O1`选项，编译器会试图减少目标码的大小和执行时间。如果指定了`-O`或`-O1`选项,，`-fthread-jumps`和`-fdefer-pop`选项将被打开。在有delay slot的机器上，`-fdelayed-branch`选项将被打开。在即使没有帧指针 (frame pointer)也支持调试的机器上，`-fomit-frame-pointer`选项将被打开。某些机器上还可能会打开其他选项。
    - -O2 : 多优化一些。除了涉及空间和速度交换的优化选项，执行几乎所有的优化工作。例如不进行循环展开(loop unrolling)和函数内嵌(inlining)。和`-O`或`-O1`选项比较，这个选项既增加了编译时间，也提高了生成代码的运行效果。
    - -O3 : 优化的更多。除了打开-O2所做的一切，它还打开了`-finline-functions`选项。
    - -O0 : 不优化
    - 在一般应用中，经常使用-O2选项
6. 有帮助的选项命令
    ```c
    gcc -E main.c // 查看预处理结果，比如头文件是哪个
    gcc -E -dM main.c > 1.txt // 把所有的宏展开，存在1.txt里
    gcc -Wp,-MD,abc.dep -c -o main.o main.c // 生成依赖文件abc.dep，Makefile会用
    ```
